<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LUIS | College Assistant</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  </head>
  <body class="bg-zinc-900 text-zinc-100 min-h-screen flex justify-center items-center">
    <main class="container mx-auto px-4 py-8">
      <div class="max-w-4xl mx-auto">
        <div class="bg-zinc-800 rounded-2xl shadow-xl overflow-hidden border border-zinc-700">
          <!-- Chat Header -->
          <div class="bg-zinc-750 px-6 py-4 border-b border-zinc-700">
            <div class="flex items-center">
              <div class="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
              <h3 class="font-medium">LUIS is online</h3>
            </div>
          </div>

          <!-- Chat Messages -->
          <div id="chatBox" class="h-96 overflow-y-auto p-6 space-y-4 bg-zinc-800/50">
            <!-- Initial bot message -->
            <div class="flex items-start space-x-3">
              <div class="bg-indigo-500 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-robot text-white text-sm"></i>
              </div>
              <div class="bg-zinc-700 rounded-2xl rounded-tl-none px-4 py-3 max-w-[85%]">
                <p class="text-zinc-100">Hi there! I'm LUIS, your college assistant. How can I help you today?</p>
              </div>
            </div>

            <!-- Example user message -->
            <div class="flex items-start justify-end space-x-3">
              <div class="bg-zinc-700 rounded-2xl rounded-tr-none px-4 py-3 max-w-[85%]">
                <p class="text-zinc-100">When is my next Computer Science class?</p>
              </div>
              <div class="bg-indigo-600 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-user text-white text-sm"></i>
              </div>
            </div>

            <!-- Example bot response -->
            <div class="flex items-start space-x-3">
              <div class="bg-indigo-500 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">
                <i class="fas fa-robot text-white text-sm"></i>
              </div>
              <div class="bg-zinc-700 rounded-2xl rounded-tl-none px-4 py-3 max-w-[85%]">
                <p class="text-zinc-100">Your Computer Science class is tomorrow at 10:00 AM in Building A, Room 204.</p>
              </div>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="bg-zinc-750 px-6 py-3 border-t border-zinc-700">
            <div class="flex overflow-x-auto space-x-2 pb-2 hide-scrollbar">
              <button class="quick-action bg-zinc-700 hover:bg-zinc-600 text-zinc-200 px-3 py-2 rounded-lg text-sm whitespace-nowrap transition-colors">
                <i class="fas fa-calendar-alt mr-1"></i> My Schedule
              </button>
            </div>
          </div>

          <!-- Input Area -->
          <div class="bg-zinc-800 p-4 border-t border-zinc-700">
            <form id="chatForm" class="flex space-x-2">
              <div class="flex-1 relative">
                <input
                  id="userInput"
                  type="text"
                  placeholder="Ask about your classes, assignments, or campus resources..."
                  class="w-full bg-zinc-700 border border-zinc-600 rounded-xl pl-4 pr-10 py-3 outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"
                />
                <button type="button" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-zinc-400 hover:text-zinc-200">
                  <i class="fas fa-paperclip"></i>
                </button>
              </div>
              <button
                class="bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white px-5 rounded-xl font-medium transition-all flex items-center justify-center"
                type="submit"
              >
                <i class="fas fa-paper-plane mr-2"></i>
                <span class="hidden sm:inline">Send</span>
              </button>
            </form>
          </div>
        </div>
      </div>
    </main>

    <script>
      const chatBox = document.getElementById("chatBox");
      const form = document.getElementById("chatForm");
      const input = document.getElementById("userInput");
      const quickActions = document.querySelectorAll('.quick-action');

      function appendMessage(text, sender) {
        const messageDiv = document.createElement("div");
        messageDiv.className = `flex items-start space-x-3 ${sender === "user" ? "justify-end" : ""}`;
        
        if (sender === "user") {
          messageDiv.innerHTML = `
            <div class="bg-zinc-700 rounded-2xl rounded-tr-none px-4 py-3 max-w-[85%]">
              <p class="text-zinc-100">${text}</p>
            </div>
            <div class="bg-indigo-600 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">
              <i class="fas fa-user text-white text-sm"></i>
            </div>
          `;
        } else {
          messageDiv.innerHTML = `
            <div class="bg-indigo-500 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">
              <i class="fas fa-robot text-white text-sm"></i>
            </div>
            <div class="bg-zinc-700 rounded-2xl rounded-tl-none px-4 py-3 max-w-[85%]">
              <p class="text-zinc-100">${text}</p>
            </div>
          `;
        }
        
        chatBox.appendChild(messageDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
      }

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const message = input.value.trim();
        if (!message) return;
        
        appendMessage(message, "user");
        input.value = "";

        // Show typing indicator
        const typingDiv = document.createElement("div");
        typingDiv.className = "flex items-start space-x-3";
        typingDiv.innerHTML = `
          <div class="bg-indigo-500 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">
            <i class="fas fa-robot text-white text-sm"></i>
          </div>
          <div class="bg-zinc-700 rounded-2xl rounded-tl-none px-4 py-3">
            <div class="flex space-x-1">
              <div class="w-2 h-2 bg-zinc-400 rounded-full animate-bounce"></div>
              <div class="w-2 h-2 bg-zinc-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
              <div class="w-2 h-2 bg-zinc-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
            </div>
          </div>
        `;
        chatBox.appendChild(typingDiv);
        chatBox.scrollTop = chatBox.scrollHeight;

        try {
          const res = await fetch("/api/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message })
          });
          const data = await res.json();
          
          // Remove typing indicator
          chatBox.removeChild(typingDiv);
          
          appendMessage(data.reply, "bot");
        } catch (error) {
          // Remove typing indicator
          chatBox.removeChild(typingDiv);
          
          // Show error message
          appendMessage("Sorry, I'm having trouble connecting right now. Please try again later.", "bot");
        }
      });

      // Quick action buttons
      quickActions.forEach(button => {
        button.addEventListener('click', () => {
          const text = button.textContent.trim();
          input.value = text;
          form.dispatchEvent(new Event('submit'));
        });
      });

      // Auto-focus input on page load
      window.addEventListener('load', () => {
        input.focus();
      });
    </script>

    <style>
      .hide-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .hide-scrollbar::-webkit-scrollbar {
        display: none;
      }
    </style>
  </body>
</html>